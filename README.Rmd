---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE, 
  message = FALSE, 
  error = FALSE, 
  warning = FALSE,
  comment = "#>"
)
```

# VARIABILIDADE ESPA√áOTEMPORAL DAS REMO√á√ïES DE CO‚ÇÇ POR ECOSSISTEMAS FLORESTAIS BRASILEIROS (2021‚Äì2023)

Reposit√≥rio de apoio ao projeto de pesquisa de mestrado com foco na an√°lise espacial e temporal das remo√ß√µes de di√≥xido de carbono (CO‚ÇÇ) pela biomassa viva de ecossistemas florestais brasileiros, no per√≠odo de 2021 a 2023, com base em dados da plataforma Climate [TRACE/CTrees](https://climatetrace.org/).

## üë®‚Äçüî¨ Autores

-   **Pedro Barbieri Durigan**\
    Mestrando em Agronomia - Ci√™ncia do Solo - FCAV/Unesp\
    Email: [pedro.durigan\@unesp.br](mailto:pedro.durigan@unesp.b)

-   **Prof. Dr. Newton La Scala J√∫nior**\
    Coorientador ‚Äî Departamento de Ci√™ncias Exatas - FCAV/Unesp\
    Email: [la.scala\@unesp.br](mailto:la.scala@unesp.br)

-   **Prof. Dr. Alan Rodrigo Panosso**\
    Coorientador ‚Äî Departamento de Ci√™ncias Exatas - FCAV/Unesp\
    Email: [alan.panosso\@unesp.br](mailto:alan.panosso@unesp.br)

## üìÅ Etapas do Projeto

Os scripts abaixo foram desenvolvidos em RMarkdown e est√£o dispon√≠veis em formato HTML:

-   [`01_aquisicao_dados`](https://arpanosso.github.io//mestrado-durigan-remocoes-co2//01_aquisicao_dados.html) ‚Äì Aquisi√ß√£o e download dos dados brutos.\
-   [`02_tratamento_dados`](https://arpanosso.github.io//mestrado-durigan-remocoes-co2//02_tratamento_dados.html) ‚Äì Faxina, filtragem e organiza√ß√£o dos dados.\
-   [`03_preprocessamento`](https://arpanosso.github.io//mestrado-durigan-remocoes-co2//03_preprocessamento.html) ‚Äì Prepara√ß√£o dos dados para an√°lise.

## üëâ [DOWNLOAD A BASE](https://drive.google.com/file/d/1EbGu6pI62J9fTxx2roxeRx6_WL4pZsbG/view?usp=drive_link)

## üì¶ **Carregando Pacotes e a Base de dados**

Importante dropar as colunas `Other` e as emiss√µes provenientes de √°reas urbanas, uma vez que est√° est√£o incorporadas nos `source_type` igual a `Municipality`. Para essa an√°lise, ser√£o consideradas apenas as remo√ß√µes e o ano at√© $2024$. Nesse caso, vamos transformar os dados de `emission_quantity` para valores positivos de remo√ß√µes.

```{r}
library(tidyverse)
library(geobr)
source("R/graph-theme.R")
emission_sources_removals <- read_rds("data/emissions_sources.rds") |> 
  select(!starts_with("Other")) |> 
  filter(
    source_type == "Municipality",
    subsector == "removals",
    year <= 2024
    ) |> 
  mutate(
    emissions_quantity = -1*emissions_quantity,
    biomes_sig = ifelse(biomes_sig == "Other","AF",biomes_sig)
  )
```


## üîç **An√°lise Explorat√≥ria dos Dados**

Visualiza√ß√µes gr√°ficas, estat√≠sticas descritivas e inspe√ß√£o de padr√µes regionais e temporais.

```{r}
country_br <- read_country(showProgress = FALSE)
  country_br |> 
    ggplot() + 
    geom_sf(fill="white", color="black",
          size=.15, show.legend = FALSE) +
    geom_point( data = emission_sources_removals |> 
       filter(year == 2021),
       aes(lon,lat,colour = biomes_sig))+
    labs(x="Longitude", y="Latitude")+
    graph_theme()
```

Criando a  tabela da estat√≠stica descritiva para as remo√ß√µes e **exportanto a tabela para pasta** `output`

```{r}
tab_stat <- emission_sources_removals |> 
  group_by(year) |> 
  summarise(
    Sum = sum(emissions_quantity, na.rm = TRUE),
    Mean = mean(emissions_quantity, na.rm = TRUE),
    Median = median(emissions_quantity, na.rm = TRUE),
    SD = sd(emissions_quantity, na.rm = TRUE),
    SSE = SD/sqrt(n()),
    Min = min(emissions_quantity, na.rm = TRUE),
    Max = max(emissions_quantity, na.rm = TRUE),
  )
writexl::write_xlsx(tab_stat,"output/est-removals.xlsx")
```


Gr√°fico das remo√ß√µes
```{r}
tab_stat |> 
  ggplot(aes(x=year, y=Sum/1e6)) +
  geom_col(color="black",fill="cyan4") +
  labs(y = expression(paste("Removal (M t ",CO[2],"e)"))) +
  theme_bw()
```
Criando a  tabela da estat√≠stica descritiva para activity e **exportanto a tabela para pasta** `output`

```{r}
tab_stat <- emission_sources_removals |> 
  group_by(biomes_sig) |> 
  summarise(
    Sum = sum(activity, na.rm = TRUE),
    Mean = mean(activity, na.rm = TRUE),
    Median = median(activity, na.rm = TRUE),
    SD = sd(activity, na.rm = TRUE),
    SSE = SD/sqrt(n()),
    Min = min(activity, na.rm = TRUE),
    Max = max(activity, na.rm = TRUE),
  )
writexl::write_xlsx(tab_stat,"output/est-activity.xlsx")
```


Gr√°fico de activity
```{r}
tab_stat |> 
  mutate(
    biomes_sig = fct_reorder(biomes_sig, Mean)
  ) |> 
  ggplot(aes(x=biomes_sig, y=Mean/1e6,fill=biomes_sig)) +
  geom_col(color="black",position = "dodge") +
  labs(y = expression(paste("Activity (M t of  ", CO[2],"in living biomass)")),
                            fill = "Biome") +
  scale_fill_viridis_d() +
  theme_bw()
```

Criando a  tabela da estat√≠stica descritiva para capacity e **exportanto a tabela para pasta** `output`

```{r}
tab_stat <- emission_sources_removals |> 
  group_by(biomes_sig) |> 
  summarise(
    Sum = sum(capacity, na.rm = TRUE),
    Mean = mean(capacity, na.rm = TRUE),
    Median = median(capacity, na.rm = TRUE),
    SD = sd(capacity, na.rm = TRUE),
    SSE = SD/sqrt(n()),
    Min = min(capacity, na.rm = TRUE),
    Max = max(capacity, na.rm = TRUE),
  )
writexl::write_xlsx(tab_stat,"output/est-capacity.xlsx")
```


Gr√°fico de capacity
```{r}
tab_stat |> 
  mutate(
    biomes_sig = fct_reorder(biomes_sig, Mean)
  ) |> 
  ggplot(aes(x=biomes_sig, y=Mean/1e6,fill=biomes_sig)) +
  geom_col(color="black",position = "dodge") +
  labs(y = expression(paste("Capacity (M t of  ", CO[2]," in living biomass per ha)")),
                            fill = "Biome") +
  scale_fill_viridis_d() +
  theme_bw()
```

## üß™ **Estat√≠stica Multivariada**

T√©cnicas como An√°lise de Componentes Principais (PCA), agrupamentos (clustering) e correla√ß√µes espaciais.

## ü§ñ **Modelagem Estat√≠stica e Preditiva**

Aplica√ß√£o de modelos de regress√£o, aprendizado de m√°quina e an√°lise de vari√°veis importantes para a predi√ß√£o das remo√ß√µes de CO‚ÇÇ.
